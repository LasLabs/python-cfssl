

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cfssl package &mdash; Python-CFSSL 0.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Python-CFSSL 0.1.0 documentation" href="index.html"/>
        <link rel="next" title="cfssl.models package" href="cfssl.models.html"/>
        <link rel="prev" title="Welcome to python-cfssl’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Python-CFSSL
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">cfssl package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cfssl.models.html">cfssl.models package</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfssl.tests.html">cfssl.tests package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-cfssl.cfssl">cfssl.cfssl module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-cfssl.defaults">cfssl.defaults module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-cfssl.exceptions">cfssl.exceptions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-cfssl">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests module</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Python-CFSSL</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>cfssl package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/cfssl.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cfssl-package">
<h1>cfssl package<a class="headerlink" href="#cfssl-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="cfssl.models.html">cfssl.models package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#module-cfssl.models.certificate_request">cfssl.models.certificate_request module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#module-cfssl.models.config_client">cfssl.models.config_client module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#module-cfssl.models.config_key">cfssl.models.config_key module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#module-cfssl.models.config_mixer">cfssl.models.config_mixer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#module-cfssl.models.config_server">cfssl.models.config_server module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#module-cfssl.models.host">cfssl.models.host module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#module-cfssl.models.policy_auth">cfssl.models.policy_auth module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#module-cfssl.models.policy_sign">cfssl.models.policy_sign module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#module-cfssl.models.policy_use">cfssl.models.policy_use module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#module-cfssl.models.subject_info">cfssl.models.subject_info module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.models.html#module-cfssl.models">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cfssl.tests.html">cfssl.tests package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#module-cfssl.tests.test_certificate_request">cfssl.tests.test_certificate_request module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#module-cfssl.tests.test_cfssl">cfssl.tests.test_cfssl module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#module-cfssl.tests.test_config_client">cfssl.tests.test_config_client module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#module-cfssl.tests.test_config_key">cfssl.tests.test_config_key module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#module-cfssl.tests.test_config_mixer">cfssl.tests.test_config_mixer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#module-cfssl.tests.test_host">cfssl.tests.test_host module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#module-cfssl.tests.test_policy_auth">cfssl.tests.test_policy_auth module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#module-cfssl.tests.test_policy_sign">cfssl.tests.test_policy_sign module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#module-cfssl.tests.test_policy_use">cfssl.tests.test_policy_use module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#module-cfssl.tests.test_subject_info">cfssl.tests.test_subject_info module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfssl.tests.html#module-cfssl.tests">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-cfssl.cfssl">
<span id="cfssl-cfssl-module"></span><h2>cfssl.cfssl module<a class="headerlink" href="#module-cfssl.cfssl" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="cfssl.cfssl.CFSSL">
<em class="property">class </em><code class="descclassname">cfssl.cfssl.</code><code class="descname">CFSSL</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>ssl=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>It provides Python bindings to a remote CFSSL server via HTTP(S).</p>
<p>Additional documentation regarding the API endpoints is available at
<a class="reference external" href="https://github.com/cloudflare/cfssl/tree/master/doc/api">https://github.com/cloudflare/cfssl/tree/master/doc/api</a></p>
<dl class="method">
<dt id="cfssl.cfssl.CFSSL.auth_sign">
<code class="descname">auth_sign</code><span class="sig-paren">(</span><em>token</em>, <em>request</em>, <em>datetime=None</em>, <em>remote_address=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL.auth_sign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL.auth_sign" title="Permalink to this definition">¶</a></dt>
<dd><p>It provides returns a signed certificate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>token</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; The authentication token.</li>
<li><strong>request</strong> (<code class="xref py py-obj docutils literal"><span class="pre">cfssl.CertificateRequest</span></code>) &#8211; Signing request document.</li>
<li><strong>datetime</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">datetime.datetime</span></code></a>) &#8211; Authentication timestamp.</li>
<li><strong>remote_address</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; An address used in making the request.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>(<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) A PEM-encoded certificate that has been signed by the</dt>
<dd><p class="first last">server.</p>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cfssl.cfssl.CFSSL.bundle">
<code class="descname">bundle</code><span class="sig-paren">(</span><em>certificate</em>, <em>private_key=None</em>, <em>flavor='ubiquitous'</em>, <em>domain=None</em>, <em>ip=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL.bundle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL.bundle" title="Permalink to this definition">¶</a></dt>
<dd><p>It builds and returns certificate bundles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>certificate</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; The PEM-encoded certificate to be bundled.</td>
</tr>
</tbody>
</table>
<p>If the <code class="docutils literal"><span class="pre">certificate</span></code> parameter is present, the following four
arguments are valid:</p>
<blockquote>
<div><dl class="docutils">
<dt>private_key (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): The PEM-encoded private key to be included with</dt>
<dd>the bundle. This is valid only if the server is not running in
<code class="docutils literal"><span class="pre">keyless</span></code> mode.</dd>
<dt>flavor (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): One of <code class="docutils literal"><span class="pre">ubiquitous</span></code>, <code class="docutils literal"><span class="pre">force</span></code>, or <code class="docutils literal"><span class="pre">optimal</span></code>,</dt>
<dd>with a default value of <code class="docutils literal"><span class="pre">ubiquitous</span></code>. A ubiquitous bundle is
one that has a higher probability of being verified everywhere,
even by clients using outdated or unusual trust stores. Force will
cause the endpoint to use the bundle provided in the
<code class="docutils literal"><span class="pre">certificate</span></code> parameter, and will only verify that the bundle
is a valid (verifiable) chain.</dd>
<dt>domain (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): The domain name to verify as the hostname of the</dt>
<dd>certificate.</dd>
<dt>ip (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): The IP address to verify against the certificate IP</dt>
<dd>SANs.</dd>
</dl>
</div></blockquote>
<p>If only the <code class="docutils literal"><span class="pre">domain</span></code> parameter is present, the following
parameter is valid:</p>
<dl class="docutils">
<dt>ip (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): The IP address of the remote host; this will fetch the</dt>
<dd>certificate from the IP, and verify that it is valid for the
domain name.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul>
<li><dl class="first docutils">
<dt>bundle contains the concatenated list of PEM certificates</dt>
<dd>forming the certificate chain; this forms the actual
bundle. The remaining parameters are additional metadata
supporting the bundle.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>crl_support is true if CRL information is contained in the</dt>
<dd>certificate.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>crt contains the original certificate the bundle is built</dt>
<dd>from.</dd>
</dl>
</li>
<li>expires contains the expiration date of the certificate.</li>
<li>hostnames contains the SAN hostnames for the certificate.</li>
<li><dl class="first docutils">
<dt>issuer contains the X.509 issuer information for the</dt>
<dd>certificate.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>key contains the private key for the certificate, if one</dt>
<dd>was presented.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>key_size contains the size of the key in bits for the</dt>
<dd>certificate. It will be present even if the private key wasn&#8217;t
provided because this can be determined from the public key.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>key_type contains a textual description of the key type,</dt>
<dd>e.g. &#8216;2048-bit RSA&#8217;.</dd>
</dl>
</li>
<li>ocsp contains the OCSP URLs for the certificate, if present.</li>
<li><dl class="first docutils">
<dt>ocsp_support will be true if the certificate supports OCSP</dt>
<dd>revocation checking.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>signature contains the signature type used in the</dt>
<dd>certificate, e.g. &#8216;SHA1WithRSA&#8217;.</dd>
</dl>
</li>
<li>status contains a number of elements:
* code is bit-encoded error code. 1st bit indicates whether<blockquote>
<div>there is a expiring certificate in the bundle. 2nd bit indicates
whether there is a ubiquity issue with the bundle.</div></blockquote>
<ul class="simple">
<li>expiring_SKIs contains the SKIs (subject key identifiers)
for any certificates that might expire soon (within 30
days).</li>
<li>messages is a list of human-readable warnings on bundle
ubiquity and certificate expiration. For example, an expiration
warning can be &#8220;The expiring cert is #1 in the chain&#8221;,
indicating the leaf certificate is expiring. Ubiquity warnings
include SHA-1 deprecation warning (if the bundle triggers
any major browser&#8217;s SHA-1 deprecation policy), SHA-2
compatibility warning (if the bundle contains signatures using
ECDSA SHA-2 hash algorithms, it will be rejected by Windows XP
SP2), compatibility warning (if the bundle contains ECDSA
certificates, it will be rejected by Windows XP, Android 2.2 and
Android 2.3 etc) and root trust warning (if the bundle cannot be
trusted by some major OSes or browsers).</li>
<li>rebundled indicates whether the server had to rebundle the
certificate. The server will rebundle the uploaded
certificate as needed; for example, if the certificate
contains none of the required intermediates or a better set
of intermediates was found. In this case, the server will
mark rebundled as true.</li>
<li>untrusted_root_stores contains the names of any major
OSes and browsers that doesn&#8217;t trust the bundle. The names
are used to construct the root trust warnings in the messages
list</li>
</ul>
</li>
<li><dl class="first docutils">
<dt>subject contains the X.509 subject identifier from the</dt>
<dd>certificate.</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>) Object repesenting the bundle, with the following keys</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cfssl.cfssl.CFSSL.call">
<code class="descname">call</code><span class="sig-paren">(</span><em>endpoint</em>, <em>method='GET'</em>, <em>params=None</em>, <em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL.call" title="Permalink to this definition">¶</a></dt>
<dd><p>It calls the remote endpoint and returns the result, if success.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>endpoint</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; CFSSL endpoint to call (e.g. <code class="docutils literal"><span class="pre">newcert</span></code>).</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; HTTP method to utilize for the Request.</li>
<li><strong>params</strong> &#8211; (dict|bytes) Data to be sent in the query string
for the Request.</li>
<li><strong>data</strong> &#8211; (<code class="xref py py-obj docutils literal"><span class="pre">dict`|:obj:`bytes`|:obj:`file</span></code>) Data to send in the body
of the Request.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(mixed) Data contained in <code class="docutils literal"><span class="pre">result</span></code> key of the API response.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-obj docutils literal"><span class="pre">CFSSLRemoteException</span></code> &#8211; In the event of a <code class="docutils literal"><span class="pre">False</span></code> in the
<code class="docutils literal"><span class="pre">success</span></code> key of the API response.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cfssl.cfssl.CFSSL.info">
<code class="descname">info</code><span class="sig-paren">(</span><em>label</em>, <em>profile=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL.info" title="Permalink to this definition">¶</a></dt>
<dd><p>It returns information about the CA, including the cert.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>label</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; A string specifying the signer.</li>
<li><strong>profile</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; a string specifying the signing profile for the
signer. Signing profile specifies what key usages should be
used and how long the expiry should be set.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>certificate (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): a PEM-encoded certificate of the signer.</li>
<li><dl class="first docutils">
<dt>usage (<a class="reference external" href="https://docs.python.org/2/library/functions.html#list" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): Key usages from the signing</dt>
<dd>profile.</dd>
</dl>
</li>
<li>expiry (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): the expiry string from the signing profile.</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>) Mapping with three keys</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cfssl.cfssl.CFSSL.init_ca">
<code class="descname">init_ca</code><span class="sig-paren">(</span><em>certificate_request</em>, <em>ca=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL.init_ca"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL.init_ca" title="Permalink to this definition">¶</a></dt>
<dd><p>It initializes a new certificate authority.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>certificate_request</strong> (<code class="xref py py-obj docutils literal"><span class="pre">cfssl.CertificateRequest</span></code>) &#8211; The certificate
request to use when creating the CA.</li>
<li><strong>ca</strong> (<code class="xref py py-obj docutils literal"><span class="pre">cfssl.ConfigServer</span></code>, optional) &#8211; The configuration of the
requested Certificate Authority.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>private key (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): a PEM-encoded CA private key.</li>
<li>certificate (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): a PEM-encoded self-signed CA certificate.</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>) Mapping with two keys</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cfssl.cfssl.CFSSL.new_cert">
<code class="descname">new_cert</code><span class="sig-paren">(</span><em>request</em>, <em>label=None</em>, <em>profile=None</em>, <em>bundle=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL.new_cert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL.new_cert" title="Permalink to this definition">¶</a></dt>
<dd><p>It generates and returns a new private key and certificate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>request</strong> (<code class="xref py py-obj docutils literal"><span class="pre">cfssl.CertificateRequest</span></code>) &#8211; CSR to be used for
certificate creation.</li>
<li><strong>label</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; Specifying which signer to be appointed to sign
the CSR, useful when interacting with cfssl server that stands
in front of a remote multi-root CA signer.</li>
<li><strong>profile</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; Specifying the signing profile for the signer.</li>
<li><strong>bundle</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>) &#8211; Specifying whether to include an &#8220;optimal&#8221;
certificate bundle along with the certificate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>private key: a PEM-encoded private key.</li>
<li>certificate_request: a PEM-encoded certificate request.</li>
<li>certificate: a PEM-encoded certificate, signed by the server.</li>
<li><dl class="first docutils">
<dt>sums: a JSON object holding both MD5 and SHA1 digests for the</dt>
<dd>certificate request and the certificate.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>bundle: See the result of endpoint_bundle.txt (only included</dt>
<dd>if the bundle parameter was set).</dd>
</dl>
</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>) mapping with these keys</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cfssl.cfssl.CFSSL.new_key">
<code class="descname">new_key</code><span class="sig-paren">(</span><em>hosts</em>, <em>names</em>, <em>common_name=None</em>, <em>key=None</em>, <em>ca=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL.new_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL.new_key" title="Permalink to this definition">¶</a></dt>
<dd><p>It generates and returns a new private key + CSR.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hosts</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#iter" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">iter</span></code></a> of <code class="xref py py-obj docutils literal"><span class="pre">cfssl.Host</span></code>) &#8211; Subject Alternative Name(s) for the
requested certificate.</li>
<li><strong>names</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#iter" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">iter</span></code></a> of <code class="xref py py-obj docutils literal"><span class="pre">cfssl.SubjectInfo</span></code>) &#8211; The Subject Info(s) for the
requested certificate.</li>
<li><strong>CN</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; the common name for the certificate subject in the
requestedrequested CA certificate.</li>
<li><strong>key</strong> (<code class="xref py py-obj docutils literal"><span class="pre">cfssl.ConfigKey</span></code>) &#8211; Cipher and strength to use for certificate.</li>
<li><strong>ca</strong> (<code class="xref py py-obj docutils literal"><span class="pre">cfssl.ConfigServer</span></code>) &#8211; the CA configuration of the requested CA.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>private key (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): a PEM-encoded CA private key.</li>
<li>certificate (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): a PEM-encoded self-signed CA certificate.</li>
<li><dl class="first docutils">
<dt>sums: (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>) Mapping holding both MD5 and SHA1 digests for the</dt>
<dd>certificate request</dd>
</dl>
</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>) Mapping with three keys</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cfssl.cfssl.CFSSL.revoke">
<code class="descname">revoke</code><span class="sig-paren">(</span><em>serial</em>, <em>authority_key_id</em>, <em>reason</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL.revoke"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL.revoke" title="Permalink to this definition">¶</a></dt>
<dd><p>It provides certificate revocation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>serial</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; Specifying the serial number of a certificate.</li>
<li><strong>authority_key_id</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; Specifying the authority key identifier
of the certificate to be revoked; this is used to distinguish
which private key was used to sign the certificate.</li>
<li><strong>reason</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; Identifying why the certificate was revoked; see,
for example, ReasonStringToCode in the ocsp package or section
4.2.1.13 of RFC 5280. The &#8220;reasons&#8221; used here are the ReasonFlag
names in said RFC.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cfssl.cfssl.CFSSL.scan">
<code class="descname">scan</code><span class="sig-paren">(</span><em>host</em>, <em>ip=None</em>, <em>timeout=None</em>, <em>family=None</em>, <em>scanner=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL.scan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL.scan" title="Permalink to this definition">¶</a></dt>
<dd><p>It scans servers to determine the quality of their TLS setup.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>host</strong> (<code class="xref py py-obj docutils literal"><span class="pre">cfssl.Host</span></code>) &#8211; The host to scan.</li>
<li><strong>ip</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; IP Address to override DNS lookup of host.</li>
<li><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; The amount of time allotted for the scan to complete
(default: 1 minute).</li>
<li><strong>family</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; regular expression specifying scan famil(ies) to run.</li>
<li><strong>scanner</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; regular expression specifying scanner(s) to run.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>(<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>) Mapping with keys for each scan family. Each of these
objects contains keys for each scanner run in that family
pointing to objects possibly containing the following keys:
* grade (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): Describing the exit status of the scan. Can be:</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;Good&#8221;: host performing the expected state-of-the-art.</li>
<li><dl class="first docutils">
<dt>&#8220;Warning&#8221;: host with non-ideal configuration,</dt>
<dd>possibly maintaining support for legacy clients.</dd>
</dl>
</li>
<li>&#8220;Bad&#8221;: host with serious misconfiguration or vulnerability</li>
<li><dl class="first docutils">
<dt>&#8220;Skipped&#8221;: indicates that the scan was not performed for some</dt>
<dd>reason.</dd>
</dl>
</li>
</ul>
</div></blockquote>
<ul class="simple">
<li>error (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>): Any error encountered during the scan process.</li>
<li>output: (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>) Arbitrary data retrieved during the scan.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cfssl.cfssl.CFSSL.scan_info">
<code class="descname">scan_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL.scan_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL.scan_info" title="Permalink to this definition">¶</a></dt>
<dd><p>It lists options available for scanning.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>) Mapping with keys for each scan family. For each family,
there exists a <cite>description</cite> containing a string describing
the family and a <cite>scanners</cite> object mapping each of the family&#8217;s
scanners to an object containing a <cite>description</cite> string.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="cfssl.cfssl.CFSSL.sign">
<code class="descname">sign</code><span class="sig-paren">(</span><em>certificate_request</em>, <em>hosts=None</em>, <em>subject=None</em>, <em>serial_sequence=None</em>, <em>label=None</em>, <em>profile=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cfssl/cfssl.html#CFSSL.sign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.cfssl.CFSSL.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>It signs and returns a certificate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>certificate_request</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; the CSR bytes to be signed (in PEM).</li>
<li><strong>hosts</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#iter" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">iter</span></code></a> of <code class="xref py py-obj docutils literal"><span class="pre">cfssl.Host</span></code>) &#8211; of SAN (subject alternative .names)
which overrides the ones in the CSR</li>
<li><strong>subject</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; The certificate subject which overrides
the ones in the CSR.</li>
<li><strong>serial_sequence</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; Specify the prefix which the generated
certificate serial should have.</li>
<li><strong>label</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) &#8211; Specifying which signer to be appointed to sign
the CSR, useful when interacting with a remote multi-root CA
signer.</li>
<li><strong>profile</strong> (<code class="xref py py-obj docutils literal"><span class="pre">cfssl.ConfigServer</span></code>) &#8211; Specifying the signing profile for
the signer, useful when interacting with a remote multi-root
CA signer.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>) A PEM-encoded certificate that has been signed by the
server.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-cfssl.defaults">
<span id="cfssl-defaults-module"></span><h2>cfssl.defaults module<a class="headerlink" href="#module-cfssl.defaults" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-cfssl.exceptions">
<span id="cfssl-exceptions-module"></span><h2>cfssl.exceptions module<a class="headerlink" href="#module-cfssl.exceptions" title="Permalink to this headline">¶</a></h2>
<dl class="exception">
<dt id="cfssl.exceptions.CFSSLException">
<em class="property">exception </em><code class="descclassname">cfssl.exceptions.</code><code class="descname">CFSSLException</code><a class="reference internal" href="_modules/cfssl/exceptions.html#CFSSLException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.exceptions.CFSSLException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/exceptions.html#exceptions.EnvironmentError" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">exceptions.EnvironmentError</span></code></a></p>
<p>This exception is raised from errors in the CFSSL Library.</p>
</dd></dl>

<dl class="exception">
<dt id="cfssl.exceptions.CFSSLRemoteException">
<em class="property">exception </em><code class="descclassname">cfssl.exceptions.</code><code class="descname">CFSSLRemoteException</code><a class="reference internal" href="_modules/cfssl/exceptions.html#CFSSLRemoteException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfssl.exceptions.CFSSLRemoteException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cfssl.exceptions.CFSSLException" title="cfssl.exceptions.CFSSLException"><code class="xref py py-class docutils literal"><span class="pre">cfssl.exceptions.CFSSLException</span></code></a></p>
<p>This exception is raised to indicate issues returned from API.</p>
</dd></dl>

</div>
<div class="section" id="module-cfssl">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-cfssl" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cfssl.models.html" class="btn btn-neutral float-right" title="cfssl.models package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to python-cfssl’s documentation!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, LasLabs Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>